<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- <%= stylesheet_link_tag 'application.css' %> -->
        <link rel="stylesheet" type="text/css" href="stylesheets/application.css" />
        <link href='http://fonts.googleapis.com/css?family=Quattrocento&v1' rel='stylesheet' type='text/css'>
        <link  href="http://fonts.googleapis.com/css?family=Waiting+for+the+Sunrise:regular&v1" rel="stylesheet" type="text/css" >
        <meta charset="utf-8" />
        <title>Main Page</title>
    </head>
    <body>
        <div id="brief">
            <div id="map_tooltip" style="display:none;"></div>
            <div id="map_canvas" style="width: 200px; height: 200px; display:none;">map div</div>
            <h1 class="title">Scott's Daily Brief<hr></h1>
            <div id="events">
                <div id="event">
                    Obama speaks at the US Chamber of Commerce<span id="tag">Federal</span><span id="tag">Employment</span><span id="urgency_tag">13 hours</span><span class="map">Location</span>
               </div>
               <div id="event">
                    Congressional hearing on federal stimulus<span id="tag">Federal</span><span id="tag">Economy</span><span id="urgency_tag">2 days</span><span class="map">Location</span>
               </div>
               <div id="event">
                    Ben Bernanke addresses the US Chamber of Commerce<span id="tag">Federal</span><span id="tag">Employment</span><span id="urgency_tag">3 days</span><span class="map">Location</span>
               </div>
              <div id="event">
                    Testimony on feasibility of high-speed rail<span id="tag">State</span><span id="tag">Transportation</span><span id="urgency_tag">6 days</span><span class="map">Location</span>
               </div>
              <div id="event">
                    Congressional debate on emissions standards<span id="tag">Federal</span><span id="tag">Environment</span><span id="urgency_tag">10 days</span><span class="map">Location</span>
               </div>
              <div id="event">
                    Tesla news conference on battery technology<span id="tag">State</span><span id="tag">Technology</span><span id="urgency_tag">2 weeks</span><span class="map">Location</span>
               </div>
            </div>
        </div>
        <div id="manilla_opening">
        </div>
        <div id="manilla_flap">
        </div>
        <div id="manilla">
            <div id="select_topics">
                <div class="manilla_title">Brief Me On</div>
                <div id="brief_topics">
                    Environmental Causes
                </div>
            </div>
            <div id="select_delivery">
                <div class="manilla_title">Deliver My Brief</div>
                <div>
                    <form id="delivery_methods">
                        <div id="email_delivery">
                            <input type="text" name="email" class="label_me" title="Email"/>
                            <!-- <span class="save_delivery"></span> -->
                        </div>
                        <div id="sms_delivery">
                            <input type="text" name="sms" class="label_me" title="SMS"/>
                            <!-- <span class="save_delivery"></span> -->
                        </div>
                        <div id="twitter_delivery">
                            <input type="text" name="twitter" class="label_me" title="Twitter"/>
                            <!-- <span class="save_delivery"></span> -->
                        </div>
                    </form>
                    <h5 class="field_info">We will notify you at the addresses above when<br>new bulletins are added to your brief.</h5>
                </div>
            </div>
        </div>
        <!-- adding jQuery and jQuery UI -->
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.js"></script>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.5/jquery-ui.min.js"></script>
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
        <script>
            var map, marker;
            var sf = new google.maps.LatLng(37.72, -122.5);

            function initialize() {
                var mapOptions = {
                zoom: 12,
                mapTypeId: google.maps.MapTypeId.ROADMAP,
                center: sf
                };

                    map = new google.maps.Map(document.getElementById("map_canvas"),
            mapOptions);
          
                marker = new google.maps.Marker({
                  map:map,
                  draggable:true,
                  animation: google.maps.Animation.DROP,
                  position: sf
                });
                google.maps.event.addListener(marker, 'click', toggleBounce);
              }

              function toggleBounce() {

                if (marker.getAnimation() != null) {
                  marker.setAnimation(null);
                } else {
                  marker.setAnimation(google.maps.Animation.BOUNCE);
                }
              }

          $('.map').toggle(function(){

            $('.map').click(function(e){ //used to be mouseover
                var loc_position = $('.map').position();
                
                $('#map_tooltip').html('<div id="map_canvas" style="width: 200px; height: 200px;">map div</div>');
                $('#map_tooltip').css({
                    //top: ((e.offsetY || e.layerY) - 60) + "px",
                   //left: ((e.offsetX || e.layerX) + 22) + "px"
                    top:loc_position.top - 60, //***this doesn't update***
                    left:loc_position.left - .5*$('#map_tooltip').width()
                });
                $('#map_tooltip').show();
                initialize();
            });
            }, function() {
                $('body').click(function(e){ //fix this interaction
                    $('#map_tooltip').hide();
                });
            });
            //Puts field title in form field
        	$('.label_me').each(function() {
        		$thisInput = $(this);
        		if ($thisInput.val() == '') {
        			$thisInput.val($thisInput.attr('title'));
        		}

        		$thisInput.focus(function() {
        			if ($(this).val() === $(this).attr('title')) {
        				$(this).val('').addClass('focused');
        			}
        		});

        		$thisInput.blur(function() {
        			if ($(this).val() === '') {
        				$(this).val($(this).attr('title')).removeClass('focused');
        			}
        		});
        	});
        </script>
    </body>
</html>
